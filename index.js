const a0_0x117b9c=a0_0x20e0;(function(_0x32cd3a,_0x514232){const _0x40d32a=a0_0x20e0,_0x1caa4b=_0x32cd3a();while(!![]){try{const _0x4b6543=-parseInt(_0x40d32a(0xea))/0x1*(parseInt(_0x40d32a(0xab))/0x2)+parseInt(_0x40d32a(0xac))/0x3+-parseInt(_0x40d32a(0xc6))/0x4+-parseInt(_0x40d32a(0xb9))/0x5*(-parseInt(_0x40d32a(0xc4))/0x6)+-parseInt(_0x40d32a(0xb8))/0x7+-parseInt(_0x40d32a(0xa5))/0x8*(-parseInt(_0x40d32a(0xaa))/0x9)+parseInt(_0x40d32a(0xf0))/0xa*(parseInt(_0x40d32a(0xa3))/0xb);if(_0x4b6543===_0x514232)break;else _0x1caa4b['push'](_0x1caa4b['shift']());}catch(_0x5686be){_0x1caa4b['push'](_0x1caa4b['shift']());}}}(a0_0x2a28,0x6f44f));import a0_0x1f8351 from'express';import a0_0x4fda44 from'path';import a0_0x51ee6d from'dotenv';import{fileURLToPath}from'url';import{windowManager}from'node-window-manager';function a0_0x20e0(_0x40bd4e,_0x319a0a){const _0x2a283b=a0_0x2a28();return a0_0x20e0=function(_0x20e0dd,_0x17fca3){_0x20e0dd=_0x20e0dd-0x96;let _0x457cbd=_0x2a283b[_0x20e0dd];return _0x457cbd;},a0_0x20e0(_0x40bd4e,_0x319a0a);}import a0_0x43ba14 from'robotjs';import a0_0x15b73b from'sharp';import a0_0x4d2b38 from'axios';function a0_0x2a28(){const _0x46b77d=['find','height','[DEBUG]\x20Texto\x20detectado\x20(sin\x20filtrar):\x20','No\x20se\x20encontró\x20ninguna\x20ventana\x20con\x20el\x20proceso\x20\x22','typeString','/procesar','español','K85093253988957','ParsedText','[DEBUG]\x20Iniciando\x20procesamiento\x20OCR\x20para\x20la\x20imagen\x20en:\x20','trim','get','keyTap','gpt-4o-mini','OCR\x20Space\x20not\x20work','choices','[ERROR]\x20No\x20se\x20pudo\x20contactar\x20con\x20OCR.Space:','user','130977oGfcwl','getWindows','64dqMnir','/ping-ocr','split','width','No\x20se\x20detectaron\x20textos\x20válidos.','553239DSJePz','52792XxMeig','292029HtlQLH','replace','[ERROR]\x20Ocurrió\x20un\x20error\x20al\x20traducir\x20manualmente:','listen','captura.png','image','habbo.exe','post','body','moveMouse','join','[ERROR]\x20Mensaje\x20del\x20error:','5678043XWnrDG','320VVxINP','getBounds','test','[ERROR]\x20Ocurrió\x20un\x20error\x20durante\x20el\x20procesamiento\x20OCR:','includes','/traducir-manual','json','push','No\x20se\x20detectaron\x20textos\x20válidos:\x20',':\x20\x22','Texto\x20enviado\x20al\x20juego:\x20\x22','46380qgwMgN','round','3082540XgoHsi','No\x20se\x20pudo\x20traducir\x20el\x20texto.','url','[DEBUG]\x20Creando\x20FormData\x20para\x20la\x20solicitud\x20a\x20OCR.Space','status','sk-BZB5aSZ9mPHHqsTfucqiQbgNMxm5gfeFUw4vYyUwLgT3BlbkFJ6J5CxnE6miKG8aYoE5rYhYy0zrhyw8a7b1XBnEoscA','ParsedResults','https://api.ocr.space/parse/image','No\x20se\x20detectó\x20texto.','[ERROR]\x20Código\x20de\x20estado\x20HTTP:','capture','path','response','dirname','\x22.\x20Solo\x20devuelve\x20el\x20texto\x20traducido.','Habbo.exe','Ventana\x20encontrada:\x20','[DEBUG]\x20Texto\x20dividido\x20en\x20líneas:','screen','png','message','data','length','Error\x20al\x20traducir\x20con\x20OpenAI:','completions','No\x20se\x20pudo\x20contactar\x20con\x20OCR.Space.','getHeaders','use','idioma','error','Dimensiones\x20de\x20la\x20ventana:\x20','[DEBUG]\x20Enviando\x20solicitud\x20POST\x20a\x20OCR.Space...','log','bringToTop','createReadStream','toFile','18YNlnKa','mouseClick','https://ocr.space','file','[ERROR]\x20Datos\x20de\x20la\x20respuesta:','Captura\x20recortada\x20guardada\x20en:\x20','1200uwOYbw','append','filter'];a0_0x2a28=function(){return _0x46b77d;};return a0_0x2a28();}import a0_0x57ca04 from'form-data';import a0_0x561ff6 from'openai';import a0_0x32e243 from'fs';a0_0x51ee6d['config']();const __filename=fileURLToPath(import.meta[a0_0x117b9c(0xc8)]),__dirname=a0_0x4fda44[a0_0x117b9c(0xd3)](__filename),openaiClient=new a0_0x561ff6({'apiKey':a0_0x117b9c(0xcb)}),app=a0_0x1f8351();app[a0_0x117b9c(0xe1)](a0_0x1f8351[a0_0x117b9c(0xbf)]());async function capturarVentana(_0x49c464,_0x1a95b6){const _0x40328a=a0_0x117b9c,_0x282d3a=windowManager['getWindows'](),_0x24c2e4=_0x282d3a[_0x40328a(0xf3)](_0x3151d=>_0x3151d['path']?.['toLowerCase']()['includes'](_0x49c464['toLowerCase']()));if(!_0x24c2e4)return console[_0x40328a(0xe6)](_0x40328a(0xf6)+_0x49c464+'\x22'),![];const _0x5c3062=_0x24c2e4['getBounds']();console['log'](_0x40328a(0xd6)+JSON['stringify'](_0x5c3062));const _0x1c844a=_0x5c3062[_0x40328a(0xf4)],_0x3122ef=Math[_0x40328a(0xc5)](_0x1c844a*0.05),_0x349b09=Math[_0x40328a(0xc5)](_0x1c844a*0.5),_0x2d6d64=_0x5c3062['y']+_0x3122ef,_0x225797=_0x1c844a-_0x3122ef-_0x349b09;_0x24c2e4[_0x40328a(0xe7)]();const _0x38cc8b=_0x5c3062['x']+_0x5c3062[_0x40328a(0xa8)]/0x2,_0x48ae53=_0x5c3062['y']+0xa;a0_0x43ba14['moveMouse'](_0x38cc8b,_0x48ae53),a0_0x43ba14[_0x40328a(0xeb)](),await new Promise(_0x1fa3ed=>setTimeout(_0x1fa3ed,0x1f4));const _0x500732=a0_0x43ba14[_0x40328a(0xd8)][_0x40328a(0xd0)](_0x5c3062['x'],_0x2d6d64,_0x5c3062[_0x40328a(0xa8)],_0x225797),_0xd9ab82=Buffer['alloc'](_0x500732[_0x40328a(0xa8)]*_0x500732['height']*0x4);let _0x2909e5=0x0;for(let _0x2db226=0x0;_0x2db226<_0x500732[_0x40328a(0xf4)];_0x2db226++){for(let _0x286e2f=0x0;_0x286e2f<_0x500732[_0x40328a(0xa8)];_0x286e2f++){const _0xb5064a=(_0x2db226*_0x500732[_0x40328a(0xa8)]+_0x286e2f)*0x4;_0xd9ab82[_0xb5064a]=_0x500732[_0x40328a(0xb1)][_0x2909e5+0x2],_0xd9ab82[_0xb5064a+0x1]=_0x500732[_0x40328a(0xb1)][_0x2909e5+0x1],_0xd9ab82[_0xb5064a+0x2]=_0x500732[_0x40328a(0xb1)][_0x2909e5],_0xd9ab82[_0xb5064a+0x3]=0xff,_0x2909e5+=0x4;}}return await a0_0x15b73b(_0xd9ab82,{'raw':{'width':_0x500732[_0x40328a(0xa8)],'height':_0x500732['height'],'channels':0x4}})[_0x40328a(0xd9)]()[_0x40328a(0xe9)](_0x1a95b6),console['log'](_0x40328a(0xef)+_0x1a95b6),!![];}async function procesarImagenOCRSpace(_0x1998e8){const _0x2c0782=a0_0x117b9c;try{console[_0x2c0782(0xe6)](_0x2c0782(0x9a)+_0x1998e8);const _0xf0aa67=new a0_0x57ca04();console[_0x2c0782(0xe6)](_0x2c0782(0xc9)),_0xf0aa67[_0x2c0782(0xf1)]('apikey',_0x2c0782(0x98)),_0xf0aa67['append'](_0x2c0782(0xed),a0_0x32e243[_0x2c0782(0xe8)](_0x1998e8)),_0xf0aa67[_0x2c0782(0xf1)]('OCREngine','2'),console[_0x2c0782(0xe6)](_0x2c0782(0xe5));const _0x2b3cde=await a0_0x4d2b38[_0x2c0782(0xb3)](_0x2c0782(0xcd),_0xf0aa67,{'headers':{..._0xf0aa67[_0x2c0782(0xe0)]()}});console[_0x2c0782(0xe6)]('[DEBUG]\x20Respuesta\x20recibida\x20de\x20OCR.Space:',_0x2b3cde[_0x2c0782(0xdb)]);const _0x257348=_0x2b3cde[_0x2c0782(0xdb)][_0x2c0782(0xcc)][0x0]?.[_0x2c0782(0x99)]||_0x2c0782(0xce);console['log'](_0x2c0782(0xf5)+_0x257348);const _0x6c8a44=_0x257348[_0x2c0782(0xa7)]('\x0a');return console['log'](_0x2c0782(0xd7),_0x6c8a44),_0x6c8a44;}catch(_0x1691c8){return console[_0x2c0782(0xe3)](_0x2c0782(0xbc)),console[_0x2c0782(0xe3)](_0x2c0782(0xb7),_0x1691c8[_0x2c0782(0xda)]),_0x1691c8[_0x2c0782(0xd2)]&&(console[_0x2c0782(0xe3)](_0x2c0782(0xee),_0x1691c8['response']['data']),console[_0x2c0782(0xe3)](_0x2c0782(0xcf),_0x1691c8[_0x2c0782(0xd2)][_0x2c0782(0xca)])),[];}}async function traducirTextosConOpenAI(_0x5efbb1,_0x361456){const _0x81f577=a0_0x117b9c,_0x285150=[];for(const _0x58efe6 of _0x5efbb1){try{const _0xc31214=await openaiClient['chat'][_0x81f577(0xde)]['create']({'messages':[{'role':_0x81f577(0xa2),'content':'Traduce\x20este\x20texto\x20al\x20'+_0x361456+_0x81f577(0xc2)+_0x58efe6+_0x81f577(0xd4)}],'model':_0x81f577(0x9e),'max_tokens':0x3e8}),_0x35bd49=_0xc31214[_0x81f577(0xa0)][0x0]?.['message']?.['content']['trim']();if(_0x35bd49)_0x285150[_0x81f577(0xc0)](_0x35bd49);}catch(_0x2d1b2f){console[_0x81f577(0xe3)](_0x81f577(0xdd),_0x2d1b2f);}}return _0x285150;}app[a0_0x117b9c(0xb3)](a0_0x117b9c(0x96),async(_0x23f000,_0x4e594c)=>{const _0x49861f=a0_0x117b9c,_0x25bdb4=_0x49861f(0xd5),_0x5c2857=a0_0x4fda44[_0x49861f(0xb6)](__dirname,_0x49861f(0xb0)),_0x3ab0f6=_0x23f000[_0x49861f(0xb4)][_0x49861f(0xe2)]||_0x49861f(0x97);try{const _0x360b25=await capturarVentana(_0x25bdb4,_0x5c2857);if(!_0x360b25)return _0x4e594c['status'](0x1f4)[_0x49861f(0xbf)]({'error':'No\x20se\x20pudo\x20capturar\x20la\x20ventana.'});const _0x157cf9=await procesarImagenOCRSpace(_0x5c2857),_0x5aca3a=_0x157cf9[_0x49861f(0xf2)](_0x14c7d1=>/^[A-Za-z0-9_]+: .+/[_0x49861f(0xbb)](_0x14c7d1));if(_0x5aca3a[_0x49861f(0xdc)]===0x0)return _0x4e594c[_0x49861f(0xbf)]({'resultado':_0x49861f(0xc1)+_0x157cf9});const _0x574bc5=await traducirTextosConOpenAI(_0x5aca3a,_0x3ab0f6);_0x4e594c['json']({'resultado':_0x574bc5});}catch(_0x4824af){_0x4e594c['status'](0x1f4)[_0x49861f(0xbf)]({'error':_0x4824af[_0x49861f(0xda)]});}}),app[a0_0x117b9c(0xb3)](a0_0x117b9c(0xbe),async(_0xf249e9,_0x1e2024)=>{const _0x4313ad=a0_0x117b9c,{idioma:_0xb6b03f,textoManual:_0x56ec0c}=_0xf249e9[_0x4313ad(0xb4)];if(!_0x56ec0c||_0x56ec0c[_0x4313ad(0x9b)]()==='')return _0x1e2024['status'](0x190)['json']({'error':'El\x20texto\x20a\x20traducir\x20no\x20puede\x20estar\x20vacío.'});try{const _0x10f74b=await traducirTextosConOpenAI([_0x56ec0c],_0xb6b03f||_0x4313ad(0x97));if(_0x10f74b[_0x4313ad(0xdc)]===0x0)return _0x1e2024['status'](0x1f4)[_0x4313ad(0xbf)]({'error':_0x4313ad(0xc7)});const _0x18101c=_0x10f74b[0x0][_0x4313ad(0xad)](/"/g,''),_0x5a56fb=windowManager[_0x4313ad(0xa4)](),_0x24b79e=_0x5a56fb[_0x4313ad(0xf3)](_0x40224b=>_0x40224b[_0x4313ad(0xd1)]?.['toLowerCase']()[_0x4313ad(0xbd)](_0x4313ad(0xb2)));if(!_0x24b79e)return console[_0x4313ad(0xe3)]('No\x20se\x20encontró\x20la\x20ventana\x20del\x20juego.'),_0x1e2024[_0x4313ad(0xca)](0x1f4)['json']({'error':'No\x20se\x20encontró\x20la\x20ventana\x20del\x20juego.'});_0x24b79e[_0x4313ad(0xe7)](),console[_0x4313ad(0xe6)]('Ventana\x20del\x20juego\x20activada.');const _0x4748cc=_0x24b79e[_0x4313ad(0xba)]();console[_0x4313ad(0xe6)](_0x4313ad(0xe4)+JSON['stringify'](_0x4748cc));const _0x20937e=_0x4748cc['x']+_0x4748cc[_0x4313ad(0xa8)]/0x2,_0x4f0035=_0x4748cc['y']+Math[_0x4313ad(0xc5)](_0x4748cc[_0x4313ad(0xf4)]*0.88);a0_0x43ba14[_0x4313ad(0xb5)](_0x20937e,_0x4f0035),a0_0x43ba14[_0x4313ad(0xeb)](),console['log']('Clic\x20en\x20la\x20barra\x20de\x20texto\x20en\x20('+_0x20937e+',\x20'+_0x4f0035+')');for(const _0x35ccfe of _0x18101c){a0_0x43ba14[_0x4313ad(0xf7)](_0x35ccfe);}return a0_0x43ba14[_0x4313ad(0x9d)]('enter'),console[_0x4313ad(0xe6)](_0x4313ad(0xc3)+_0x18101c+'\x22'),_0x1e2024[_0x4313ad(0xbf)]({'resultado':_0x18101c});}catch(_0x45b1f5){return console['error'](_0x4313ad(0xae),_0x45b1f5[_0x4313ad(0xda)]),_0x1e2024[_0x4313ad(0xca)](0x1f4)[_0x4313ad(0xbf)]({'error':'Error\x20al\x20traducir\x20el\x20texto\x20manual.'});}}),app[a0_0x117b9c(0x9c)](a0_0x117b9c(0xa6),async(_0xa5b057,_0x1531c9)=>{const _0xd28612=a0_0x117b9c;try{const _0x588739=await a0_0x4d2b38[_0xd28612(0x9c)](_0xd28612(0xec),{'timeout':0x1388});return _0x588739[_0xd28612(0xca)]===0xc8?_0x1531c9['json']({'status':'ok','message':'OCR\x20Space\x20working'}):_0x1531c9[_0xd28612(0xbf)]({'status':_0xd28612(0xe3),'message':_0xd28612(0x9f)});}catch(_0x5bb6f4){return console[_0xd28612(0xe3)](_0xd28612(0xa1),_0x5bb6f4[_0xd28612(0xda)]),_0x1531c9['json']({'status':_0xd28612(0xe3),'message':_0xd28612(0xdf)});}});const PORT=0x152a;app[a0_0x117b9c(0xaf)](PORT,async(_0x447de6,_0x4c3094)=>{const _0x5481d9=a0_0x117b9c;console[_0x5481d9(0xe6)]('Servidor\x20corriendo\x20en\x20http://localhost:'+PORT);const _0x794d50=_0x5481d9(0xd5),_0x446c22=a0_0x4fda44[_0x5481d9(0xb6)](__dirname,_0x5481d9(0xb0)),_0x14f6dd=_0x5481d9(0x97);try{const _0x2f75e4=await procesarImagenOCRSpace(_0x446c22),_0x14e067=_0x2f75e4[_0x5481d9(0xf2)](_0x171175=>/^[A-Za-z0-9_]+: .+/[_0x5481d9(0xbb)](_0x171175));if(_0x14e067[_0x5481d9(0xdc)]===0x0)return _0x4c3094[_0x5481d9(0xbf)]({'resultado':_0x5481d9(0xa9)});console[_0x5481d9(0xe6)](_0x14e067);const _0x5dc8e5=await traducirTextosConOpenAI(_0x14e067,_0x14f6dd);console[_0x5481d9(0xe6)](_0x5dc8e5);}catch(_0x2f2758){console[_0x5481d9(0xe6)](_0x2f2758[_0x5481d9(0xda)]);}});