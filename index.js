const a0_0x44f8a5=a0_0x3281;(function(_0x437ffc,_0x5353b6){const _0x4a1c03=a0_0x3281,_0x160f68=_0x437ffc();while(!![]){try{const _0x222b96=-parseInt(_0x4a1c03(0xfe))/0x1+-parseInt(_0x4a1c03(0x104))/0x2+parseInt(_0x4a1c03(0x118))/0x3+-parseInt(_0x4a1c03(0x112))/0x4+-parseInt(_0x4a1c03(0x146))/0x5*(-parseInt(_0x4a1c03(0x115))/0x6)+-parseInt(_0x4a1c03(0x110))/0x7+parseInt(_0x4a1c03(0xeb))/0x8*(parseInt(_0x4a1c03(0x11c))/0x9);if(_0x222b96===_0x5353b6)break;else _0x160f68['push'](_0x160f68['shift']());}catch(_0x2b3d16){_0x160f68['push'](_0x160f68['shift']());}}}(a0_0x517e,0xbe918));import a0_0x419c95 from'express';import a0_0x390f56 from'path';import a0_0x59e1e6 from'dotenv';import{fileURLToPath}from'url';import{windowManager}from'node-window-manager';import a0_0x45fe2c from'robotjs';import a0_0x4af123 from'sharp';import a0_0x3b639f from'axios';import a0_0x52230e from'form-data';import a0_0x5562b0 from'openai';import a0_0x14260e from'fs';a0_0x59e1e6['config']();const __filename=fileURLToPath(import.meta[a0_0x44f8a5(0xf5)]),__dirname=a0_0x390f56[a0_0x44f8a5(0x13b)](__filename),openaiClient=new a0_0x5562b0({'apiKey':process['env'][a0_0x44f8a5(0xf7)]}),app=a0_0x419c95();function a0_0x3281(_0x2bef5d,_0x379e80){const _0x517ee2=a0_0x517e();return a0_0x3281=function(_0x32816d,_0x4c3728){_0x32816d=_0x32816d-0xe9;let _0x4ec959=_0x517ee2[_0x32816d];return _0x4ec959;},a0_0x3281(_0x2bef5d,_0x379e80);}app[a0_0x44f8a5(0x13e)](a0_0x419c95[a0_0x44f8a5(0x12f)]());function a0_0x517e(){const _0x404c1a=['log','choices','stringify','OCR\x20Space\x20working','No\x20se\x20detectaron\x20textos\x20válidos:\x20','keyTap','includes','https://api.ocr.space/parse/image','enter','captura.png','2681133LvrLTi','message','2623760eLPjvl','create','idioma','6GuTjSB','body','capture','3116451yyxfFg','completions','moveMouse','https://ocr.space','144mJCSfc','/procesar','[DEBUG]\x20Iniciando\x20procesamiento\x20OCR\x20para\x20la\x20imagen\x20en:\x20','[ERROR]\x20Mensaje\x20del\x20error:','split','toLowerCase','content','filter','height','data','join','response','round',':\x20\x22','replace','alloc','Clic\x20en\x20la\x20barra\x20de\x20texto\x20en\x20(','post','status','json','El\x20texto\x20a\x20traducir\x20no\x20puede\x20estar\x20vacío.','No\x20se\x20detectó\x20texto.','getBounds','[ERROR]\x20Código\x20de\x20estado\x20HTTP:','path','toFile','append','push','trim','[DEBUG]\x20Texto\x20detectado\x20(sin\x20filtrar):\x20','ParsedResults','dirname','habbo.exe','[ERROR]\x20Ocurrió\x20un\x20error\x20durante\x20el\x20procesamiento\x20OCR:','use','No\x20se\x20pudo\x20traducir\x20el\x20texto.','[DEBUG]\x20Enviando\x20solicitud\x20POST\x20a\x20OCR.Space...','No\x20se\x20pudo\x20capturar\x20la\x20ventana.','Servidor\x20corriendo\x20en\x20http://localhost:','find','width','Traduce\x20este\x20texto\x20al\x20','3072005roINGm','image','español','user','chat','get','1052848YxnnAe','K85093253988957','OCR\x20Space\x20not\x20work','[DEBUG]\x20Creando\x20FormData\x20para\x20la\x20solicitud\x20a\x20OCR.Space','getWindows','Dimensiones\x20de\x20la\x20ventana:\x20','png','Habbo.exe','mouseClick','test','url','[ERROR]\x20Ocurrió\x20un\x20error\x20al\x20traducir\x20manualmente:','API_KEY_OPENAI','createReadStream','No\x20se\x20encontró\x20la\x20ventana\x20del\x20juego.','bringToTop','length','Ventana\x20del\x20juego\x20activada.','error','1179825kAyZEQ','typeString','[DEBUG]\x20Respuesta\x20recibida\x20de\x20OCR.Space:','getHeaders','\x22.\x20Solo\x20devuelve\x20el\x20texto\x20traducido.','/traducir-manual','1519124FUKVsz','/ping-ocr'];a0_0x517e=function(){return _0x404c1a;};return a0_0x517e();}async function capturarVentana(_0x2b8898,_0x4acaca){const _0x5804c7=a0_0x44f8a5,_0x56162d=windowManager[_0x5804c7(0xef)](),_0xcea0f1=_0x56162d['find'](_0x1f3c02=>_0x1f3c02[_0x5804c7(0x134)]?.['toLowerCase']()['includes'](_0x2b8898[_0x5804c7(0x121)]()));if(!_0xcea0f1)return console[_0x5804c7(0x106)]('No\x20se\x20encontró\x20ninguna\x20ventana\x20con\x20el\x20proceso\x20\x22'+_0x2b8898+'\x22'),![];const _0x5644be=_0xcea0f1[_0x5804c7(0x132)]();console[_0x5804c7(0x106)]('Ventana\x20encontrada:\x20'+JSON['stringify'](_0x5644be));const _0x26a07c=_0x5644be['height'],_0x4d593b=Math['round'](_0x26a07c*0.05),_0x3d0435=Math[_0x5804c7(0x128)](_0x26a07c*0.5),_0x21f8da=_0x5644be['y']+_0x4d593b,_0x40d11e=_0x26a07c-_0x4d593b-_0x3d0435;_0xcea0f1[_0x5804c7(0xfa)]();const _0x384cad=_0x5644be['x']+_0x5644be[_0x5804c7(0x144)]/0x2,_0x19eff0=_0x5644be['y']+0xa;a0_0x45fe2c[_0x5804c7(0x11a)](_0x384cad,_0x19eff0),a0_0x45fe2c[_0x5804c7(0xf3)](),await new Promise(_0x5368c3=>setTimeout(_0x5368c3,0x1f4));const _0x280055=a0_0x45fe2c['screen'][_0x5804c7(0x117)](_0x5644be['x'],_0x21f8da,_0x5644be[_0x5804c7(0x144)],_0x40d11e),_0x468f73=Buffer[_0x5804c7(0x12b)](_0x280055[_0x5804c7(0x144)]*_0x280055['height']*0x4);let _0x4ebb50=0x0;for(let _0x1da3ba=0x0;_0x1da3ba<_0x280055[_0x5804c7(0x124)];_0x1da3ba++){for(let _0xd9d283=0x0;_0xd9d283<_0x280055['width'];_0xd9d283++){const _0x568edb=(_0x1da3ba*_0x280055[_0x5804c7(0x144)]+_0xd9d283)*0x4;_0x468f73[_0x568edb]=_0x280055['image'][_0x4ebb50+0x2],_0x468f73[_0x568edb+0x1]=_0x280055[_0x5804c7(0x147)][_0x4ebb50+0x1],_0x468f73[_0x568edb+0x2]=_0x280055[_0x5804c7(0x147)][_0x4ebb50],_0x468f73[_0x568edb+0x3]=0xff,_0x4ebb50+=0x4;}}return await a0_0x4af123(_0x468f73,{'raw':{'width':_0x280055[_0x5804c7(0x144)],'height':_0x280055[_0x5804c7(0x124)],'channels':0x4}})[_0x5804c7(0xf1)]()[_0x5804c7(0x135)](_0x4acaca),console[_0x5804c7(0x106)]('Captura\x20recortada\x20guardada\x20en:\x20'+_0x4acaca),!![];}async function procesarImagenOCRSpace(_0x5853eb){const _0x8ca10f=a0_0x44f8a5;try{console['log'](_0x8ca10f(0x11e)+_0x5853eb);const _0x25b90d=new a0_0x52230e();console[_0x8ca10f(0x106)](_0x8ca10f(0xee)),_0x25b90d[_0x8ca10f(0x136)]('apikey',_0x8ca10f(0xec)),_0x25b90d[_0x8ca10f(0x136)]('file',a0_0x14260e[_0x8ca10f(0xf8)](_0x5853eb)),_0x25b90d[_0x8ca10f(0x136)]('OCREngine','2'),console['log'](_0x8ca10f(0x140));const _0x17e145=await a0_0x3b639f[_0x8ca10f(0x12d)](_0x8ca10f(0x10d),_0x25b90d,{'headers':{..._0x25b90d[_0x8ca10f(0x101)]()}});console['log'](_0x8ca10f(0x100),_0x17e145[_0x8ca10f(0x125)]);const _0x4b1060=_0x17e145[_0x8ca10f(0x125)][_0x8ca10f(0x13a)][0x0]?.['ParsedText']||_0x8ca10f(0x131);console['log'](_0x8ca10f(0x139)+_0x4b1060);const _0x326439=_0x4b1060[_0x8ca10f(0x120)]('\x0a');return console[_0x8ca10f(0x106)]('[DEBUG]\x20Texto\x20dividido\x20en\x20líneas:',_0x326439),_0x326439;}catch(_0x391b22){return console['error'](_0x8ca10f(0x13d)),console[_0x8ca10f(0xfd)](_0x8ca10f(0x11f),_0x391b22[_0x8ca10f(0x111)]),_0x391b22[_0x8ca10f(0x127)]&&(console['error']('[ERROR]\x20Datos\x20de\x20la\x20respuesta:',_0x391b22['response'][_0x8ca10f(0x125)]),console[_0x8ca10f(0xfd)](_0x8ca10f(0x133),_0x391b22[_0x8ca10f(0x127)]['status'])),[];}}async function traducirTextosConOpenAI(_0x31dbf0,_0x4e0288){const _0x305121=a0_0x44f8a5,_0x3fd24f=[];for(const _0x2d8b0e of _0x31dbf0){try{const _0x46ef89=await openaiClient[_0x305121(0xe9)][_0x305121(0x119)][_0x305121(0x113)]({'messages':[{'role':_0x305121(0x149),'content':_0x305121(0x145)+_0x4e0288+_0x305121(0x129)+_0x2d8b0e+_0x305121(0x102)}],'model':'gpt-4o-mini','max_tokens':0x3e8}),_0x1b187b=_0x46ef89[_0x305121(0x107)][0x0]?.['message']?.[_0x305121(0x122)][_0x305121(0x138)]();if(_0x1b187b)_0x3fd24f[_0x305121(0x137)](_0x1b187b);}catch(_0x5503f0){console['error']('Error\x20al\x20traducir\x20con\x20OpenAI:',_0x5503f0);}}return _0x3fd24f;}app[a0_0x44f8a5(0x12d)](a0_0x44f8a5(0x11d),async(_0x2241c0,_0x45ed50)=>{const _0x51644a=a0_0x44f8a5,_0x4d374d=_0x51644a(0xf2),_0x279263=a0_0x390f56[_0x51644a(0x126)](__dirname,_0x51644a(0x10f)),_0x514976=_0x2241c0[_0x51644a(0x116)][_0x51644a(0x114)]||_0x51644a(0x148);try{const _0x1e4c20=await capturarVentana(_0x4d374d,_0x279263);if(!_0x1e4c20)return _0x45ed50[_0x51644a(0x12e)](0x1f4)[_0x51644a(0x12f)]({'error':_0x51644a(0x141)});const _0x1423ca=await procesarImagenOCRSpace(_0x279263),_0x4cffdc=_0x1423ca[_0x51644a(0x123)](_0x2d1d91=>/^[A-Za-z0-9_]+: .+/[_0x51644a(0xf4)](_0x2d1d91));if(_0x4cffdc[_0x51644a(0xfb)]===0x0)return _0x45ed50[_0x51644a(0x12f)]({'resultado':_0x51644a(0x10a)+_0x1423ca});const _0x5cce20=await traducirTextosConOpenAI(_0x4cffdc,_0x514976);_0x45ed50[_0x51644a(0x12f)]({'resultado':_0x5cce20});}catch(_0x59d67a){_0x45ed50[_0x51644a(0x12e)](0x1f4)[_0x51644a(0x12f)]({'error':_0x59d67a[_0x51644a(0x111)]});}}),app[a0_0x44f8a5(0x12d)](a0_0x44f8a5(0x103),async(_0x18641b,_0x1372c3)=>{const _0x4f67cd=a0_0x44f8a5,{idioma:_0x50058f,textoManual:_0x196511}=_0x18641b[_0x4f67cd(0x116)];if(!_0x196511||_0x196511[_0x4f67cd(0x138)]()==='')return _0x1372c3[_0x4f67cd(0x12e)](0x190)[_0x4f67cd(0x12f)]({'error':_0x4f67cd(0x130)});try{const _0x5105cd=await traducirTextosConOpenAI([_0x196511],_0x50058f||_0x4f67cd(0x148));if(_0x5105cd[_0x4f67cd(0xfb)]===0x0)return _0x1372c3[_0x4f67cd(0x12e)](0x1f4)[_0x4f67cd(0x12f)]({'error':_0x4f67cd(0x13f)});const _0x4d8b6c=_0x5105cd[0x0][_0x4f67cd(0x12a)](/"/g,''),_0x158381=windowManager[_0x4f67cd(0xef)](),_0x47aa2f=_0x158381[_0x4f67cd(0x143)](_0x248c40=>_0x248c40[_0x4f67cd(0x134)]?.[_0x4f67cd(0x121)]()[_0x4f67cd(0x10c)](_0x4f67cd(0x13c)));if(!_0x47aa2f)return console[_0x4f67cd(0xfd)](_0x4f67cd(0xf9)),_0x1372c3[_0x4f67cd(0x12e)](0x1f4)[_0x4f67cd(0x12f)]({'error':_0x4f67cd(0xf9)});_0x47aa2f[_0x4f67cd(0xfa)](),console[_0x4f67cd(0x106)](_0x4f67cd(0xfc));const _0x4b2602=_0x47aa2f['getBounds']();console[_0x4f67cd(0x106)](_0x4f67cd(0xf0)+JSON[_0x4f67cd(0x108)](_0x4b2602));const _0x35725f=_0x4b2602['x']+_0x4b2602[_0x4f67cd(0x144)]/0x2,_0x2c918e=_0x4b2602['y']+Math[_0x4f67cd(0x128)](_0x4b2602['height']*0.88);a0_0x45fe2c[_0x4f67cd(0x11a)](_0x35725f,_0x2c918e),a0_0x45fe2c[_0x4f67cd(0xf3)](),console[_0x4f67cd(0x106)](_0x4f67cd(0x12c)+_0x35725f+',\x20'+_0x2c918e+')');for(const _0x1292a2 of _0x4d8b6c){a0_0x45fe2c[_0x4f67cd(0xff)](_0x1292a2);}return a0_0x45fe2c[_0x4f67cd(0x10b)](_0x4f67cd(0x10e)),console[_0x4f67cd(0x106)]('Texto\x20enviado\x20al\x20juego:\x20\x22'+_0x4d8b6c+'\x22'),_0x1372c3[_0x4f67cd(0x12f)]({'resultado':_0x4d8b6c});}catch(_0x351880){return console[_0x4f67cd(0xfd)](_0x4f67cd(0xf6),_0x351880[_0x4f67cd(0x111)]),_0x1372c3['status'](0x1f4)[_0x4f67cd(0x12f)]({'error':'Error\x20al\x20traducir\x20el\x20texto\x20manual.'});}}),app['get'](a0_0x44f8a5(0x105),async(_0x241bac,_0x4fa48c)=>{const _0x1b9854=a0_0x44f8a5;try{const _0xc40edc=await a0_0x3b639f[_0x1b9854(0xea)](_0x1b9854(0x11b),{'timeout':0x1388});return _0xc40edc[_0x1b9854(0x12e)]===0xc8?_0x4fa48c['json']({'status':'ok','message':_0x1b9854(0x109)}):_0x4fa48c[_0x1b9854(0x12f)]({'status':_0x1b9854(0xfd),'message':_0x1b9854(0xed)});}catch(_0x430f3a){return console['error']('[ERROR]\x20No\x20se\x20pudo\x20contactar\x20con\x20OCR.Space:',_0x430f3a[_0x1b9854(0x111)]),_0x4fa48c[_0x1b9854(0x12f)]({'status':_0x1b9854(0xfd),'message':'No\x20se\x20pudo\x20contactar\x20con\x20OCR.Space.'});}});const PORT=0x152a;app['listen'](PORT,async(_0x39ad1a,_0x3c9cd3)=>{const _0x6f9107=a0_0x44f8a5;console['log'](_0x6f9107(0x142)+PORT);const _0x4866bb=_0x6f9107(0xf2),_0x5a7ceb=a0_0x390f56['join'](__dirname,_0x6f9107(0x10f)),_0x45f6c0=_0x6f9107(0x148);try{const _0x3ac124=await procesarImagenOCRSpace(_0x5a7ceb),_0x5b1f3a=_0x3ac124[_0x6f9107(0x123)](_0x28b618=>/^[A-Za-z0-9_]+: .+/[_0x6f9107(0xf4)](_0x28b618));if(_0x5b1f3a[_0x6f9107(0xfb)]===0x0)return _0x3c9cd3[_0x6f9107(0x12f)]({'resultado':'No\x20se\x20detectaron\x20textos\x20válidos.'});console[_0x6f9107(0x106)](_0x5b1f3a);const _0xbc6f8c=await traducirTextosConOpenAI(_0x5b1f3a,_0x45f6c0);console[_0x6f9107(0x106)](_0xbc6f8c);}catch(_0x34becd){console[_0x6f9107(0x106)](_0x34becd[_0x6f9107(0x111)]);}});